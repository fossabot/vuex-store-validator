{"version":3,"file":"index.umd.js","sources":["../src/engines/ajv.js","../src/engines/joi.js","../src/constants.js","../src/index.js","../src/validator.js","../src/factory.js"],"sourcesContent":["import Ajv from 'ajv';\n\nconst getErrorMessages = (errors) => errors.map((item) => item.message).join(', ');\n\nexport default (schema, data) => {\n  const ajv = new Ajv({ jsonPointers: true, $data: true });\n  const validate = ajv.compile(schema);\n  validate(data);\n\n  const { errors } = validate;\n\n  return errors ? `ValidationError: ${getErrorMessages(errors)}` : false;\n};\n","export default (schema, data) => {\n  const format = schema || { validate: () => ({}) };\n  const { error } = format.validate(data);\n\n  return error || false;\n};\n","export default Object.freeze({\n  JOI: 'joi',\n  AJV: 'ajv',\n});\n","import validator from './validator';\nimport Constants from './constants';\n\nexport default class VuexStoreValidator {\n  constructor({ engine = Constants.JOI, strict = false, extend = {} } = {}) {\n    Object.assign(this, { engine, strict, extend });\n\n    return validator(this);\n  }\n}\n\n/* istanbul ignore next */\nif (window.Vue) {\n  window.VuexStoreValidator = VuexStoreValidator;\n}\n\nexport const ENGINE = Constants;\n","import factory from './factory';\n\nconst validator = ({ extend, strict, engine }) => (store) => {\n  const { _modules: modules, _modulesNamespaceMap: modulesNamespaceMap } = store;\n\n  const getModuleByNamespace = (namespace) => {\n    let name = namespace;\n    if (name && namespace.charAt(namespace.length - 1) !== '/') {\n      name += '/';\n    }\n\n    const module = modulesNamespaceMap[name];\n\n    return module;\n  };\n\n  const getRulesByType = (type) => {\n    const target = '_rawModule';\n    const pathArray = type.split('/');\n    const fn = pathArray.pop();\n    const module = getModuleByNamespace(pathArray.join('/'));\n    const { rules = {} } = (module || modules.root)[target];\n\n    if (strict && !rules[fn]) {\n      throw new Error(`[Strict Mode] Rules are not defined for: ${type}`);\n    }\n\n    return rules[fn];\n  };\n\n  store.subscribe(({ type, payload }) => {\n    const error = factory(engine, extend)(getRulesByType(type), payload);\n\n    if (error) {\n      throw new Error(`${error} for mutation: ${type}`);\n    }\n  });\n};\n\nexport default validator;\n","import ajv from './engines/ajv';\nimport joi from './engines/joi';\n\nconst factory = (key, extend) => {\n  const available = { ajv, joi, ...extend };\n\n  if (Object.keys(available).includes(key)) {\n    return available[key];\n  }\n\n  throw new Error(`Validation Engine for \"${key}\" not found.`);\n};\n\nexport default factory;\n"],"names":["schema","data","validate","Ajv","jsonPointers","$data","compile","errors","map","item","message","join","getErrorMessages","format","error","Object","freeze","JOI","AJV","VuexStoreValidator","constructor","engine","Constants","strict","extend","assign","this","store","_modules","modules","_modulesNamespaceMap","modulesNamespaceMap","subscribe","type","payload","key","available","ajv","joi","keys","includes","Error","factory","pathArray","split","fn","pop","module","namespace","name","charAt","length","getModuleByNamespace","rules","root","getRulesByType","validator","window","Vue"],"mappings":"kSAIA,OAAgBA,EAAQC,KACtB,MACMC,EADM,IAAIC,EAAI,CAAEC,cAAc,EAAMC,OAAO,IAC5BC,QAAQN,GAC7BE,EAASD,GAET,MAAMM,OAAEA,GAAWL,EAEnB,QAAOK,GAAU,oBATOA,CAAAA,GAAWA,EAAOC,IAAKC,GAASA,EAAKC,SAASC,KAAK,MASvCC,CAAiBL,OCXvCP,EAAQC,KACtB,MAAMY,EAASb,GAAU,CAAEE,SAAU,WAC/BY,MAAEA,GAAUD,EAAOX,SAASD,GAElC,OAAOa,IAAS,KCJHC,OAAOC,OAAO,CAC3BC,IAAK,MACLC,IAAK,cCCcC,EACnBC,aAAYC,OAAEA,EAASC,EAAUL,IAArBM,OAA0BA,GAAS,EAAnCC,OAA0CA,EAAS,IAAO,IAGpE,OAFAT,OAAOU,OAAOC,KAAM,CAAEL,OAAAA,EAAQE,OAAAA,EAAQC,OAAAA,ICHxB,GAAGA,OAAAA,EAAQD,OAAAA,EAAQF,OAAAA,KAAcM,IACjD,MAAQC,SAAUC,EAASC,qBAAsBC,GAAwBJ,EA2BzEA,EAAMK,UAAU,EAAGC,KAAAA,EAAMC,QAAAA,MACvB,MAAMpB,EC5BM,EAACqB,EAAKX,KACpB,MAAMY,EAAY,CAAEC,IAAAA,EAAKC,IAAAA,KAAQd,GAEjC,GAAIT,OAAOwB,KAAKH,GAAWI,SAASL,GAClC,OAAOC,EAAUD,GAGnB,UAAUM,MAAO,0BAAyBN,kBDqB1BO,CAAQrB,EAAQG,EAAhBkB,CAfQT,CAAAA,IACtB,MACMU,EAAYV,EAAKW,MAAM,KACvBC,EAAKF,EAAUG,MACfC,EAfsBC,CAAAA,IAC5B,IAAIC,EAAOD,EAOX,OANIC,GAAmD,MAA3CD,EAAUE,OAAOF,EAAUG,OAAS,KAC9CF,GAAQ,KAGKlB,EAAoBkB,IASpBG,CAAqBT,EAAUhC,KAAK,OAC7C0C,MAAEA,EAAQ,KAAQN,GAAUlB,EAAQyB,MAAnB,WAEvB,GAAI/B,IAAW8B,EAAMR,GACnB,UAAUJ,MAAO,4CAA2CR,GAG9D,OAAOoB,EAAMR,IAIyBU,CAAetB,GAAOC,GAE5D,GAAIpB,EACF,UAAU2B,MAAO,GAAE3B,mBAAuBmB,QD3BrCuB,CAAU9B,OAKjB+B,OAAOC,MACTD,OAAOtC,mBAAqBA,YAGRG"}